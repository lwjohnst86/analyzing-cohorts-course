```{r}
source("preamble.R")
```

# Chapter 1: Introduction to cohorts and types of research questions

**Objectives:**

- Know that analyzing cohorts is just as much about the process/workflow as it
is about the specific tools/statistics to use.
- Recognize the type of cohort design from the data
- Know which research questions can and cannot be asked of the given data
- Have a general understand of which statistical tests to use for which data and
that the test will dictate how the data should look.
- Know where to look and what resources to use if you can't find the statistical
or analytical techniques needed to analyze the data.

## Lesson 1: Introduction to cohort designs

*Content*
- Purpose of cohort studies ... why have them and what do they provide.
- Intro to some jargon:
    - cohorts (all participants share a common characteristic), types, outcomes,
    predictors/exposure, risk factors (fill out as I go along)
- Outline of course, focusing on workflow/process
- Types of cohort designs:
    - Prospective (no exposure, no disease), retrospective (exposure, but no
    disease), cross-sectional analysis of cohort (based on type of data
    available), nested case-control (won't necessarily be teaching how to
    analyze all these, will teach about the process for working with this type
    of data and what is important to present; note, these designs are very
    economically efficient and also very powerful... high cost-benefit ratio).
- Incidence vs prevalence

### Exercise: Which is which study type?

Usually 

- MCQ/text: Series of examples of study designs and data collection protocols...
identify which is prospective, retrospective, etc.

### Exercise: (maybe)

MCQ: Scenarios to highlight which is prevalence, which is incidence.
Or question about which data type/study type is retrospective (nickel data) vs
prospective (framingham/diet).

### Exercise: What type of cohort design is this dataset?

NE/MCQ with console: Here is a dataset. Which of the options is the design?
{{maybe as a bullet exercise with multiple datasets and different MCQ responses.}}

## Lesson 2: Typical analyses used

*Content*
- Introduction to datasets we will use throughout
- General look of data:
    - Show how the data looks:
        - baseline visit with disease status followup (time to disease, or age
        at diagnosis, or age at death, etc)
        - multiple data collection waves (ID and Wave columns)
        - Data will look very similar between prospective vs retrospective, the
        difference being how the data was collected... need to check what the
        variables mean, so need to refer to the documentation.
    - State assumptions first about the data (e.g. data already collected), this
    is not a course on how to conduct and collect cohort data.

*Exercises*
- NE: Quickly look over data (simple, like head or something). Type out in order 
which is prospective, which is retrospective, etc.
- MCQ/text: Limitation of retrospective over prospective (from an analytic and
interpretation point of view).
- MCQ/text: General limitations of prospective cohorts (again from analytic or
interpretation view)

### Exercise: Number of disease states

NE: Calculate the number of cases of each disease (at each time point if needed).

```{r}

```


### Exercise: Extract outcome and expos
NE: (simple one) Extract the outcome and exposure(s) from the {n} datasets

```{r}
# make the answer be slightly fluid since different exposures could be chosen.
# But need to make sure that only specific exposures are chosen.
framingham %>% 
    select(cvd, totchol, bmi, hdlc)

nickel %>% 
    select(lungcancer, exposure) # need to confirm this

dietchd %>% 
    select(chd, y, energy, fat, fibre)
```

### Exercise 1: Here's data and a question, which test to use?

Text? or MCQ?: Show example data. Which statistics to use for this?
Or maybe choose which stats belongs with which data type? Or which question
belongs with which data and statistic?

### Exercise 2: First steps, exploration

NE: Run summary statistics on those with the disease and those without.

```{r}
library(dplyr)
library(broom)
load("datasets/nickel.rda")
nickel %>% 
    group_by(icd) %>% 
    summarize(mean = mean(exposure), sd = sd(exposure))

load("datasets/framingham.rda")
framingham %>% 
    group_by(period, cvd) %>% 
    # TODO: choose other variables.
    summarize(meanChol = mean(totchol, na.rm = TRUE), meanBMI = mean(bmi, na.rm = TRUE))
```

Note:
We can already see that those who had a cancer were also exposed the most in the
`nickel` dataset.

## Lesson 3: Scientific questions that can be asked of cohort data

*Content*
- research questions able to be asked from data and impact on stats
    - retrospective, can ask questions like:
- {{Add more here}}

*Exercises*
- MCQ/text: Given dataset, which questions can be asked based on data.
- MCQ/text: Which question needs which statistic? (hmm maybe not)
- Simpson's paradox? 

### Exercise 1:
Text? MCQ?: Which research question belongs with which dataset?

# Extra

- Sources of bias (not at this stage) TODO: move to analysis or wrangling chapter?
- odds ratio, relative risk, incidence rate ratio
    - risk estimate of some type, for instance of diseases that are not binary
    - which questions will need which statistic
