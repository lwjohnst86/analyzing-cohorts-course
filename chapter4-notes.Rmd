```{r}
source("preamble.R")
```

# Chapter 4: Presentation of your results

**Objectives**

- Give careful thought into how to best show results in a understandable and
impactful way for public health professionals and clinicians.
- Emphasize figures over tables, but know when to use either.
- Be cautious in interpreting "non-significant" findings, since they could also
have meaningful clinical implications.
- Use cautious language when presenting results
    - Especially with "causal" language
- Discuss STROBE guidelines in context of longitudinal study.

- Extract model results?

## Lesson 1: Language and information to use when communicating the findings

- Danger of not showing all results or proper cautious interpretation, because
lives are at risk.
- Highlighting uncertainty and magnitude of results over "statistical significance"
- When to use stronger causal language
    - Depending on magnitude of finding, can use stronger causal language.
    - e.g. with smoking and lung cancer
    - Often argued that only Randomized Controlled Trials or animal/cell experiments 
    can use causal language, but that isn't always true.
    - Bradford Hill criteria (e.g. being smoking and lung cancer)
- Most of the time, your target audience for your results/analysis of cohort
studies is people in public health or government or clinicians... so you really
need to make sure that your results are *understandable* to *them*, not to other
data scientists or statisticians or epidemiologists (though you also need to 
target them).
- Discuss STROBE guidelines in context of longitudinal study.
    - Keep coming back to this throughout the chapter

**Exercises to reinforce learning:**

- MCQ/text: Which is the most appropriate language to use when describing these
results:
    - {large effect size} {strong causal language}
    - .. etc. fill out later.
- Do coding exercise with effect size then into comment about proper language.
    
### Exercise: Using causal or stronger "effect" language when discussing results

{{Bradford Hill *guideline* is also covered in the other epi courses... but
worth it to repeat since it is important}}

{{focus on these aspects: strength/effect size, consistency/replicability,
temporality, biological plausibility... these also apply to all aspects of causal
reasoning in all of science... even with all of these, may not be causal, but
have a common causal downstream factor.}}

Thinking about using stronger language


### Exercise: Using STROBE to guide presentation

{{MCE}}

Why is it important to present both unadjusted and adjusted models in your final
report (or slides, poster, or other publication outlet)?

- STROBE told me to do it, of course
- It's not important, only the adjusted models matter!
- Either unadjusted or adjusted can be biased, so need to show both {{expand/edit}}

    
### Exercise: Showing and interpreting your findings

{{MCE}}
{{TODO: Find an real life example (I booked one somewhere a while ago, just need to find it)}}

A finding shows that a exposure has a OR of 0.80 (0.59, 1.01 95% CI, p=0.09).
The paper says the association was non-significant and don't further discuss it.
Without knowing the specifics of the actual analysis, which choices would suggest
the paper should have discussed the association more {{wording}}:
    - effect of type of milk (or feeding) on premature infant mortality
    - others, fill out...

## Lesson 2: Back transforming results for easier interpretation

- Backtransform based on what is most meaningful for presenting
- Types of backtransformation and impact on interpretation. (Should this be in
chapter 3?)
- Backtransforming for maximal interpretation and meaning
- STROBE guidelines
    - "consider translating estimates of relative risk into absolute risk for a
    meaningful time period"
    - Such as person years

### Exercise: Backtransforming of results

```{r}
results %>% 
    # If exposures were logged... interpreted as percent difference
    mutate_at(vars(estimate, conf.low, conf.high), funs(exp(. - 1) * 100))
# TODO: add others transformations.
```

## Lesson 3: Communicating your results through graphs

- Table or figure? When to use either
    - Above all, try to use a figure. They tend to show results the best,
    quickest, and are more intuitive/understandable then tables.
    - But not all results work in a figure.
- STROBE guidelines
    - "Report other analyses done—eg analyses of subgroups and interactions, and
    sensitivity analyses"

### Exercise: estimate and CI plot

{{NE}}

Most frequently, cohort analyses end up having an estimate of some type along with
some measure of uncertainty about that estimate (e.g. 95% confidence interval).
Sometimes it might be fine to present these results as a table, however this
is rarely recommended (even though many researchers still do this). The best way
to communicate your results, to communicate the magnitude of association and
how much uncertainty there is, is through a plot. Create a plot of the model results.

```{r}
# TODO: Include a title that gives a quick summary of results... using appropriate language
# TODO: Use previous results (or just provide the result dataframe so they can start plotting)
results %>% 
    ggplot(aes(y = terms, x = estimate, xmin = conf.low, xmax = conf.high)) +
    geom_errorbarh(aes(height = 0.2)) +
    facet_grid( ~ outcomes, scales = "free")
```

### Exercise: Plotting unadjusted and adjusted models of your results

{{NE}}

Most journals and reviewers will request showing both unadjusted and adjusted results
as the results between these can be informative and insightful into the underlying
research question. In fact, STROBE has a guideline for including and discussing
these results, and any potential differences between. Create a plot of your results
showing different levels of adjustment.

```{r}
bind_rows(
    unadj_model %>% mutate(Model = "Unadjusted"),
    adj_model %>% mutate(Model = "Adjusted")
) %>% 
    ggplot(aes(y = terms, x = estimate, xmin = conf.low, xmax = conf.high)) +
    geom_errorbarh(aes(height = 0.2)) +
    facet_grid(Models ~ outcomes, scales = "free")
```

### Exercise: Subgroup plot

{{TabExercise with MCE and NE?}}

You decide before hand that you will do a subgroup analysis filtering out those
who dropped out vs those who remained. You find out there is no difference between
these two groups. Do you:

- Not show the null findings and just present your main results
- Show your subgroup analyses in figures, either in the main report or as a supplement

Based on the STROBE guidelines (and just being a good researcher), you should always
show findings that you've done even if they are null or don't have any difference.
    - STROBE: "Report other analyses done—eg analyses of subgroups and interactions, and
    sensitivity analyses"

### Exercise: Plotting and interpreting interaction associations

E.g. a sex or time by predictor interaction

```{r}
# TODO: Will need to confirm a time interaction (or just show it regardless...)
```

## Lesson 4: Using tables to convey your findings

- What to show when using tables
    - Disparate estimates from models or results (e.g. showing results from full 
    model, that includes both discrete and continuous exposures)
- Tables are useful to use to show the data of the figure.
    - Tables more machine readable 
    - (though arguably the data for the figure should be provided with the
    figure)
- This is especially important for meta-analyses done on the topic of your results.
- STROBE: "Cohort study—Report numbers of outcome events or summary measures over time"

**Exercises:**

- MCQ/text: Which results/analyses would be best as a table or as a figure?
    - ...


### Exercise: Basic cohort characteristic table

This is a very common usage for tables, as presenting diverse data types in a 
single format is challenging for figure, which is usually the case with descriptive
tables. In fact, including this descriptive information is part of the STROBE
guidelines.

```{r}
framingham %>% 
    outline_table(header = "period") %>% 
    add_rows(..., stat = stat_meanSD) %>% 
    build_table()
```

### Exercise: Table alongside figure of events over time

Sometimes it is very useful to show the table of results, which more information,
along side a figure of the results. This is especially useful when reporting
the number of outcome events over time. You already created a figure of the
outcomes over time in Lesson 3 {{show it, plus the code}}, now create a table of
the same findings plus other useful information such as total number of events,
total number of participants, and percent of events for each time period.

```{r}
framingham %>% 
    add_count(period) %>% 
    rename(Total = n) %>% 
    count(period, cvd, Total) %>% 
    rename(Events = n) %>% 
    knitr::kable()
```

### Exercise: Create a table of the results

Sometimes it is useful for researchers doing meta-analyses to have the numbers
available from the cohort analysis results to use in their own research. In this
way, the figure is not enough. So including a table of the results can be useful
as a supplement to the figure.

```{r}
results %>% 
    mutate_at(vars(estimate, conf.low, conf.high), round, digits = 1) %>% 
    mutate(EstCI = glue::glue("{estimate} ({conf.low}, {conf.high})")) %>% # or stringr::str_c or paste0
    select(Model, Predictors = terms, `Estimate (95% CI)` = EstCI) %>% 
    knitr::kable(caption = "Caption here") # or pander
```

Notice how the p-value is not included here. When trying to communicate results
that can have health impacts, its important to focus on the important parts ... 
the magnitude of association, not on some arbitrary p-value threshold. The
magnitude is more informative, especially for clinicians and public health
practitioners. This is currently a "controversial" stance and opinion, however, 
it is backed by evidence and fact... fact that the p-value is misused and
misinterpreted. For matters of health, misinterpretation can lead to worse
health, greater disease, and death... the lives of people are on the line.
